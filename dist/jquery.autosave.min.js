var Autosave=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){var n,o,a;o=[t,!function(){var e=new Error("Cannot find module 'jquery'");throw e.code="MODULE_NOT_FOUND",e}()],void 0===(a="function"==typeof(n=function(e,t){"use strict";function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=(n=t)&&n.__esModule?n:{default:n};var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n=e,a=[{key:"_setItem",value:function(r){var n=e._getFullItem(),o=(0,t.default)(r).closest("form").attr(e.DEFAULTS.formAttr),a=(0,t.default)(r).index(),u=!1,i=r.value;t.default.each(n,function(e,t){t.id===o&&t.i===a&&(t.text=i,t.reset=!1,u=!0)}),u||n.push({id:o,i:a,text:i,reset:!1}),e.onPage=""!==i,window.localStorage.setItem(e.DEFAULTS.storageName,JSON.stringify(n))}},{key:"_getFullItem",value:function(){return JSON.parse(window.localStorage.getItem(e.DEFAULTS.storageName))||[]}},{key:"_getText",value:function(r,n){var o=(0,t.default)(r).closest("form").attr(e.DEFAULTS.formAttr),a=(0,t.default)(r).index(),u="";return t.default.each(this._getFullItem(),function(e,t){t.id!==o||t.i!==a||(!n||!1!==t.reset)&&n||(u=t.text)}),u}},{key:"bind",value:function(t){if(90===t.keyCode&&t.ctrlKey){if(""!==this.value)return!0;this.value=e._getText(this,!1),e._setItem(this)}else t.ctrlKey||e._setItem(this)}},{key:"restore",value:function(){if(""===this.value){var t=e._getText(this,!0);this.value=t,e.onPage=""!==t}}},{key:"reset",value:function(){var r=e._getFullItem(),n=(0,t.default)(this).closest("form").attr(e.DEFAULTS.formAttr);t.default.each(r,function(t,r){r.id===n&&(r.reset=!0,e.onPage=!1)}),window.localStorage.setItem(e.DEFAULTS.storageName,JSON.stringify(r))}},{key:"remove",value:function(r){var n=e._getFullItem(),o=(0,t.default)(r).attr(e.DEFAULTS.formAttr);t.default.each(n,function(t,r){if(r&&r.id===o){var a=n.indexOf(r);a>-1&&n.splice(a,1),e.onPage=!1}}),window.localStorage.setItem(e.DEFAULTS.storageName,JSON.stringify(n))}},{key:"exitAjax",value:function(){return!(!e.onPage||confirm(e.DEFAULTS.msgExit)&&(e.onPage=!1,1))}}],(o=null)&&r(n.prototype,o),a&&r(n,a),e;var n,o,a}(),a=o;e.default=a,o.DEFAULTS={storageName:"autosave",formClass:".autosave-form",formAttr:"data-autosave",msgExit:"Возможно, внесенные изменения не сохранятся."},o.onPage=!1,(0,t.default)(document).on("keyup",o.DEFAULTS.formClass+" textarea",o.bind),(0,t.default)(document).on("reset",o.DEFAULTS.formClass,o.reset),(0,t.default)(function(){(0,t.default)(o.DEFAULTS.formClass).has(":visible").find("textarea").each(o.restore)}),(0,t.default)(window).on("beforeunload",function(){if(o.onPage)return o.DEFAULTS.msgExit})})?n.apply(t,o):n)||(e.exports=a)}]);