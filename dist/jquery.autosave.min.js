var Autosave=Autosave||{};Autosave.storageName="autosave",Autosave._setItem=function(t){var e=Autosave._getFullItem(),a=$(t).closest("form").attr("data-autosave"),o=$(t).index(),s=!1,u=t.value;$.each(e,function(t,e){e.id==a&&e.i==o&&(e.text=u,e.reset=!1,s=!0)}),s||e.push({id:a,i:o,text:u,reset:!1}),window.localStorage.setItem(Autosave.storageName,JSON.stringify(e))},Autosave._getFullItem=function(){return JSON.parse(window.localStorage.getItem(Autosave.storageName))||[]},Autosave._getText=function(t,e){var a=$(t).closest("form").attr("data-autosave"),o=$(t).index(),s="";return $.each(Autosave._getFullItem(),function(t,u){if(u.id==a&&u.i==o&&(e&&0==u.reset||!e))return void(s=u.text)}),s},Autosave.bind=function(t){if(90==t.keyCode&&t.ctrlKey){if(""!=this.value)return!0;this.value=Autosave._getText(this,!1),Autosave._setItem(this)}else t.ctrlKey||Autosave._setItem(this)},Autosave.restore=function(){""==this.value&&(this.value=Autosave._getText(this,!0))},Autosave.reset=function(){var t=Autosave._getFullItem(),e=$(this).closest("form").attr("data-autosave");$.each(t,function(t,a){a.id==e&&(a.reset=!0)}),window.localStorage.setItem(Autosave.storageName,JSON.stringify(t))},Autosave.remove=function(t){var e=Autosave._getFullItem(),a=$(t).attr("data-autosave");$.each(e,function(t,o){if(o.id==a){var s=e.indexOf(o);s>-1&&e.splice(s,1)}}),window.localStorage.setItem(Autosave.storageName,JSON.stringify(e))},$(document).on("keyup",".autosave-form textarea",Autosave.bind),$(document).on("reset",".autosave-form",Autosave.reset),$(function(){$(".autosave-form textarea").each(Autosave.restore)});